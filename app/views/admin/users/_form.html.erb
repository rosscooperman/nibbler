<%= error_messages_for :user, :header => false %>

<% form_for :user, @user, :url => (@user.new_record? ? admin_users_path : admin_user_path(@user)), :html => {:method => (@user.new_record? ? :post : :put)} do |f| -%>
  <dl>
    <%= f.dl_text_field :email, :required => true %>

    <% unless f.object.new_record? %>
    <dt id="change_password_link">
      <%= link_to_function "Change Password", "$('#change_password').toggle();$('#change_password_link').toggle()" %>
    </dt>
    <% end %>
  </dl>

  <dl id="change_password"<% unless f.object.new_record? %> style="display:none"<% end %>>
    <%= f.dl_password_field :password, :required => true %>
    <%= f.dl_password_field :password_confirmation, :text => 'Confirm password', :required => true %>
  </dl>

  <dl>
    <%= f.dl_create_or_update_button(admin_users_path, admin_users_path) %>
  </dl>
<% end -%>